# Summary

Code review of MC Dashboard Visibility changes across 10 files. Overall quality is good â€” consistent styling, proper TypeScript usage, and clean React patterns. A few issues noted below.

## Issues

### ðŸ”´ High

1. **Inline style in `mission-view.tsx:29`** â€” `style={{ gridTemplateColumns: "3fr 2fr", height: "calc(100vh - 240px)" }}` violates the Tailwind-only rule. Should use `grid-cols-[3fr_2fr]` and `h-[calc(100vh-240px)]`.

2. **Missing `"use client"` in `mission-view.tsx`** â€” This component renders client components (`WorkerPanel`, `GateConditionsPanel`) and is imported by `mc-client.tsx` (a client component), but it has no `"use client"` directive. While it works because the parent is a client boundary, it's inconsistent with the project convention where all interactive components have the directive.

### ðŸŸ¡ Medium

3. **Unused variable in `worker-panel.tsx:54`** â€” `activeCount` is computed but `workers.length` is the only varying metric displayed. The `activeCount` badge is rendered, but the variable computation filters for `busy | running | spawning` while the hook's `WorkerStatus` type also includes these â€” just worth verifying these match the actual server states.

4. **Unsafe cast in `adapters.ts:46`** â€” `raw.status as Worker["status"]` casts any string to `WorkerStatus` without validation. A malformed server message could propagate an invalid status through the UI silently. Consider a fallback to `"offline"`.

5. **Unsafe cast in `adapters.ts:63`** â€” `raw.stage as GateCriteria["stage"]` has the same issue â€” casts any string to `Stage` without validation.

6. **`sessions` cast in `adapters.ts:76`** â€” `(raw.sessions ?? []) as TokenSummary["sessions"]` blindly trusts the shape. If the server sends partial session objects, downstream `.reduce()` calls in `token-usage-panel.tsx` will throw.

7. **`mcState.audit` and `mcState.checkpoints` not passed to `ActivityView`** in `mc-client.tsx:62-63` â€” hardcoded as empty arrays `audit={[]}` and `checkpoints={[]}` despite being available on `mcState`. This means the activity view will never show audit/checkpoint data.

### ðŸŸ¢ Low

8. **`onKillWorker` prop in `mission-view.tsx`** is received and passed to `ZoneGroup` but also passed to `WorkerPanel` implicitly through `workers` â€” `WorkerPanel` has no kill action, which is fine, but the prop exists on `MissionView` without being used in the new panels.

9. **`sendChat` and `approveGate`** returned from `useMCWebSocket` are not used in `mc-client.tsx` â€” the client creates its own fetch-based handlers instead. Consider removing the duplicates from the hook or using them.

10. **`connected` state duplication** in `use-mc-websocket.ts` â€” Both `useState(false)` for `connected` AND `MCState.connected` exist. The hook spreads `...state` (which includes `state.connected` set during sync) and also returns the separate `connected` state variable, meaning the latter wins. Works but is confusing.

## Style & Patterns

- âœ… Tailwind-only styling (except issue #1)
- âœ… Proper `"use client"` directives on hooks and interactive components (except #2)
- âœ… Consistent font-mono / color palette across all new panels
- âœ… Clean adapter layer separating raw WS data from UI types
- âœ… Proper cleanup in hooks (refs, intervals, `active` flags)
- âœ… Default exports for lazy-loadable panels, named exports for compositions
