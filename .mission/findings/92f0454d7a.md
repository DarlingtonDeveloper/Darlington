# Summary

Mission 2 goal: Wire the MC Dashboard backend API routes and build frontend views for audit trail, findings, and briefings.

## Goal Statement

Fix the MissionControl backend so all `api.Server.Routes()` endpoints are mounted and accessible, add new endpoints for findings/briefings content, then wire the Darlington frontend to consume audit events (including real-time WebSocket), render findings markdown, and display briefing JSON.

## Success Criteria

### Backend (MissionControl repo)

| #   | Criterion                                       | Metric                                                                                                                                            |
| --- | ----------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------- |
| B1  | `serve.go` mounts `api.Server.Routes()`         | `GET /api/audit`, `/api/tasks`, `/api/graph`, `/api/gates`, `/api/zones`, `/api/checkpoints` all return 200 (not 404)                             |
| B2  | `/api/audit` returns audit trail                | Response matches `{entries: AuditEntry[], total: number, limit: number, offset: number}`; supports `?category=`, `?actor=`, `?limit=`, `?offset=` |
| B3  | `/api/tasks/{id}/findings` serves markdown      | Returns findings `.md` content with `Content-Type: text/markdown` for tasks that have findings; 404 for missing                                   |
| B4  | `/api/tasks/{id}/briefing` serves briefing JSON | Returns handoff briefing JSON with `Content-Type: application/json` for tasks that have briefings; 404 for missing                                |
| B5  | Existing tests pass                             | `go test ./...` exits 0 with no regressions                                                                                                       |

### Frontend (Darlington repo)

| #   | Criterion                             | Metric                                                                                      |
| --- | ------------------------------------- | ------------------------------------------------------------------------------------------- |
| F1  | Activity view shows real audit events | Fetches from `/api/audit`, renders entries with timestamp, action, actor, category, details |
| F2  | Findings browser                      | Task list; clicking a task fetches `/api/tasks/{id}/findings` and renders markdown inline   |
| F3  | Briefings browser                     | Task list; clicking a task fetches `/api/tasks/{id}/briefing` and displays formatted JSON   |
| F4  | Real-time audit via WebSocket         | Subscribes to `audit` topic on `/ws`; new audit entries appear without page refresh         |

## Scope Boundaries

- **In scope:** Route mounting fix, findings/briefings endpoints, frontend views for audit/findings/briefings, WebSocket audit subscription
- **Out of scope:** Requirements coverage (stays placeholder), new task CRUD UI, gate approval UI changes, authentication/authorization

## Risk Notes

- Route mounting change touches all API endpoints — must verify no handler conflicts between `serve.go` inline handlers and `api/routes.go` handlers (health, status, tokens, workers, requirements already work inline)
- Findings/briefings endpoints read from filesystem — need path traversal protection on task ID parameter
