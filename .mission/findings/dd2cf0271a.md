# Summary

Completed T1 infrastructure fixes across 3 files in `lib/mc/`.

## Changes

### `lib/mc/types.ts`

- Extended `WorkerStatus` with `spawning`, `running`, `complete`, `failed`
- Added `started_at`, `model` fields to `Worker`
- Changed `GateCriteria.criteria` from `string[]` to `GateCriterion[]` (`{description, met}`)
- Added `approval_note` to `GateCriteria`
- Added `budget_remaining` to `TokenSummary`
- Added `audit: AuditEntry[]` and `checkpoints: CheckpointInfo[]` to `MCState`
- All existing types preserved

### `lib/mc/adapters.ts` (new)

- `adaptWorker()`: Maps `worker_id` → `id`, `token_count` → `tokens`, computes `uptime` from `started_at`
- `adaptGate()`: Normalises criteria from string[] or object[] to `GateCriterion[]`
- `adaptTokens()`: Maps `total_cost_usd` → `total_cost`, passes through `budget_remaining`
- Exports raw interfaces for use in WS handler

### `lib/mc/use-mc-websocket.ts`

- Added handlers for `audit`, `checkpoint`, `zone`, `chat` topics in switch
- `initial_state` now does full state replacement (not merge) using adapters
- Worker events use `adaptWorker()`, gate events use `adaptGate()`
- Added `request_sync` message sent on WebSocket open (reconnect support)
- `initialState` includes `audit: []`, `checkpoints: []`, `budget_remaining: 0`

## Verification

- `tsc --noEmit` passes cleanly
- All 9 subscribed WS topics have explicit handlers (no unhandled default)
